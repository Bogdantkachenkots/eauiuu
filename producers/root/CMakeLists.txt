FIND_PACKAGE(ROOT)

INCLUDE(${ROOT_USE_FILE})


SET(ROOTProducer_name ROOTProducer)
SET(ROOTProducer_DICTIONARY ${ROOTProducer_name}Dict)
SET(ROOTProducer_SOURCES
  src/ROOTProducer.cpp
  src/DemoHardware.cpp
  )


ROOT_GENERATE_DICTIONARY(${ROOTProducer_DICTIONARY}  MODULE ${ROOTProducer_DICTIONARY} ROOTProducer.h DemoHardware.h)

ADD_LIBRARY( ${ROOTProducer_name} SHARED ${ROOTProducer_SOURCES} ${ROOTProducer_DICTIONARY})
TARGET_INCLUDE_DIRECTORIES(${ROOTProducer_name} PRIVATE 
  $<BUILD_INTERFACE:${CMAKE_SOURCE_DIR}/producers/root/inc> )
TARGET_LINK_LIBRARIES(${ROOTProducer_name} EUDAQ ${ROOT_LIBRARIES} ${ADDITIONAL_LIBRARIES})

INSTALL(TARGETS ${ROOTProducer_name}
  RUNTIME DESTINATION bin COMPONENT ROOTPRODUCER
  LIBRARY DESTINATION lib COMPONENT ROOTPRODUCER
  ARCHIVE DESTINATION lib COMPONENT ROOTPRODUCER
  )

IF(${ROOT_VERSION} GREATER 5)
  SET(ROOTProducer_PCM ${CMAKE_BINARY_DIR}/producers/root/lib${ROOTProducer_DICTIONARY}_rdict.pcm)
  INSTALL(FILES
    ${ROOTProducer_PCM}
    DESTINATION lib COMPONENT ROOTPRODUCER
    )
ENDIF(${ROOT_VERSION} GREATER 5)
